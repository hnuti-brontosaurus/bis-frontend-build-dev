{"version":3,"file":"static/js/565.a0691ddd.chunk.js","mappings":"sPACA,EAA6Y,wC,WCmBhYA,EAAoB,YAKC,IAJhCC,EAI+B,EAJ/BA,OAI+B,IAH/BC,WAAAA,OAG+B,MAHlB,EAGkB,EAF/BC,EAE+B,EAF/BA,SACAC,EAC+B,EAD/BA,SAEMC,EAAkD,yCAAG,WAAMC,GAAN,8EACrDA,EAAEC,OAAOC,OAASF,EAAEC,OAAOC,MAAMC,OAAS,IACtCC,EAAOJ,EAAEC,OAAOC,MAAM,IACtBG,EAAS,IAAIC,YACZC,mBAAmBH,GAC1BC,EAAOG,OAAS,WACd,IAAMC,EAAKC,EAAAA,GAAUL,EAAOM,OAAQ,CAAEC,KAAM,WAMtCC,EALOH,EAAAA,GAAAA,cACID,EAAGK,OAAOL,EAAGM,WAAW,IAAK,CAC1CC,OAAQ,IAETC,MAAMrB,GAENsB,KAAI,SAAAC,GAAK,OAAIC,EAAAA,EAAAA,IAAgBD,EAAoBxB,EAAxC,IAET0B,QAAO,SAAAC,GAAG,OAAIC,OAAOC,KAAK7B,GAAQ8B,MAAK,SAAAC,GAAG,OAAIJ,EAAII,EAAR,GAAhC,IACb5B,EAASe,EACV,GAjBsD,2CAAH,sDAoBxD,OACE,mBAAOc,UAAWC,EAAlB,UACG/B,GACD,kBACEe,KAAK,OACLiB,OAAO,sGACPC,SAAU/B,MAIjB,EAID,G","sources":["webpack://bis-frontend/./src/components/ImportExcelButton/ImportExcelButton.module.scss?44b6","components/ImportExcelButton/ImportExcelButton.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"button\":\"ImportExcelButton_button__GbUan\",\"icon\":\"ImportExcelButton_icon__onmrF\",\"smallButton\":\"ImportExcelButton_smallButton__oILSS\",\"primary\":\"ImportExcelButton_primary__bhCuJ\",\"secondary\":\"ImportExcelButton_secondary__crt2k\",\"tertiary\":\"ImportExcelButton_tertiary__Rmff1\",\"danger\":\"ImportExcelButton_danger__M-5Zk\",\"disabled\":\"ImportExcelButton_disabled__ozwta\",\"importButton\":\"ImportExcelButton_importButton__dvrbw\"};","/**\n * This button imports data from excel\n *\n * Never import it directly, but only from components!\n * Because it's lazily loaded and in fact you're exporting LazyImportExcelButton\n */\nimport { ChangeEventHandler, ReactNode } from 'react'\nimport { Schema } from 'type-fest'\nimport { array2object } from 'utils/helpers'\nimport * as xlsx from 'xlsx'\nimport styles from './ImportExcelButton.module.scss'\n\nexport interface ImportExcelButtonProps<T extends {}> {\n  // keyMap is a config which says how to map columns in imported document (keyMap values) onto imported object (keyMap keys)\n  keyMap: Schema<T, number>\n  headerRows?: number\n  children: ReactNode\n  onUpload: (data: T[]) => void\n}\n\nexport const ImportExcelButton = <T extends {}>({\n  keyMap,\n  headerRows = 1,\n  children,\n  onUpload,\n}: ImportExcelButtonProps<T>) => {\n  const handleUpload: ChangeEventHandler<HTMLInputElement> = async e => {\n    if (e.target.files && e.target.files.length > 0) {\n      const file = e.target.files[0]\n      const reader = new FileReader()\n      reader.readAsBinaryString(file)\n      reader.onload = () => {\n        const wb = xlsx.read(reader.result, { type: 'binary' })\n        const json = xlsx.utils\n          .sheet_to_json(wb.Sheets[wb.SheetNames[0]], {\n            header: 1,\n          })\n          .slice(headerRows)\n        const normalizedJson = json\n          .map(entry => array2object<T>(entry as unknown[], keyMap))\n          // ignore rows that imported nothing\n          .filter(row => Object.keys(keyMap).some(key => row[key as keyof T]))\n        onUpload(normalizedJson)\n      }\n    }\n  }\n  return (\n    <label className={styles.importButton}>\n      {children}\n      <input\n        type=\"file\"\n        accept=\"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/csv\"\n        onChange={handleUpload}\n      />\n    </label>\n  )\n}\n\n// we need to export to later import it with React.lazy\n// eslint-disable-next-line import/no-default-export\nexport default ImportExcelButton\n"],"names":["ImportExcelButton","keyMap","headerRows","children","onUpload","handleUpload","e","target","files","length","file","reader","FileReader","readAsBinaryString","onload","wb","xlsx","result","type","normalizedJson","Sheets","SheetNames","header","slice","map","entry","array2object","filter","row","Object","keys","some","key","className","styles","accept","onChange"],"sourceRoot":""}